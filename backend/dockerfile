# java 8 위에서 스프링 부트 앱이 실행
FROM openjdk:8-jdk-alpine AS build
WORKDIR /var/jenkins_home/workspace/kwwDeployTest/backend
COPY gradlew .
COPY gradle gradle
COPY build.gradle .
COPY settings.gradle .
COPY src src
RUN chmod +x gradlew
RUN ["./gradlew", "clean", "bootJar", "--stacktrace", "--exclude-task", "test"]
# 도커 노출 포트
FROM openjdk:8-jdk-alpine
EXPOSE 8085
VOLUME /tmp
# 어떤 어플리케이션을 실행하는지 실행파일을 연결
# gradle build를 통해 생성한 .jar 파일의 위치
# 경로 확인이 중요
# 상대 경로로 적어서 다른 팀원의 개발환경에 적용
ARG JAR_FILE=build/libs/README-0.0.1-SNAPSHOT.jar
COPY ${JAR_FILE} app.jar
# 어플리케이션 실행 명령어 : java 실행 명령어
ENTRYPOINT ["java","-jar","/app.jar"]
ARG DEBIAN_FRONTEND=noninteractive
ENV TZ=Asia/Seoul